apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: app-of-apps        # 상위 애플리케이션 이름
  namespace: app-of-apps        # ArgoCD가 설치된 네임스페이스 (보통 argocd)
spec:
  project: default         # 사용할 ArgoCD 프로젝트 (없다면 기본값)
  source:
    repoURL: 'https://github.com/jiheon2/ArgoCD.git'  # Git 리포지토리 URL
    targetRevision: main   # 브랜치 혹은 태그 (예: HEAD, main 등)
    path: overlays/app-of-apps             # 자식 앱들이 위치한 경로 (apps 디렉토리)
  destination:
    server: 'https://kubernetes.default.svc'  # 배포할 클러스터 API 서버 주소
    namespace: app-of-apps      # 자식 앱들이 배포될 네임스페이스 (필요에 따라 변경)
  syncPolicy:
    automated:             # 자동 동기화 옵션
      prune: true          # 불필요한 리소스 제거
      selfHeal: true       # 설정 불일치 시 자동 복구